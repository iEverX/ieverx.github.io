<!DOCTYPE html>
<html lang="zh-CN">
    
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>从Jekyll迁移到Hugo</title>
    <link rel="stylesheet" href="https://blog.guolx.com/style.css">
    <link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/lxgw-wenkai-webfont/1.6.0/style.min.css" />
</head>


<body>
    <div class="container">
        <div class="block-container">
                
<div id="header" class="header">
    <div class="header-container">
        <div class="brand">
            <h1 class="u-link">
                <a href="https://blog.guolx.com">天外天</a>
            </h1>
        </div>
        



<div class="nav-container">
    <div class="nav">
        
            
                
                
                
                
    <div class="u-link nav-item">
        <a href="https:&#x2F;&#x2F;blog.guolx.com&#x2F;post&#x2F;">archive</a>
    </div>

            
        
            
                
                
                
                
    <div class="u-link nav-item">
        <a href="https:&#x2F;&#x2F;blog.guolx.com&#x2F;arts&#x2F;">arts</a>
    </div>

            
        
            
                
                
                
    <div class="u-link nav-item">
        <a href="https:&#x2F;&#x2F;blog.guolx.com&#x2F;tags">tags</a>
    </div>

            
        
            
                
                
                
                
                
    <div class="u-link nav-item">
        <a href="https:&#x2F;&#x2F;blog.guolx.com&#x2F;message-board&#x2F;">messages</a>
    </div>

            
        
            
                
                
                
                
                
    <div class="u-link nav-item">
        <a href="https:&#x2F;&#x2F;blog.guolx.com&#x2F;pages&#x2F;links&#x2F;">links</a>
    </div>

            
        
            
                
    <div class="u-link nav-item">
        <a href="https:&#x2F;&#x2F;github.com&#x2F;iEverX">github</a>
    </div>

            
        
    </div>
    <div class="clearfix"></div>
</div>



    </div>
</div>

            
<div class="post">    
    <h1 class="post-title">从Jekyll迁移到Hugo</h1>
    
<div class="post-meta">
    <span class="post-date">2018-03-10</span>
    
        &middot;
            <span class="post-tag u-link">
                <a href="https://blog.guolx.com/tags/jekyll/">#Jekyll</a>
            </span>
        
            <span class="post-tag u-link">
                <a href="https://blog.guolx.com/tags/hugo/">#Hugo</a>
            </span>
        
            <span class="post-tag u-link">
                <a href="https://blog.guolx.com/tags/travis-ci/">#Travis CI</a>
            </span>
        
    
    
        &middot;
        <span class="word_count">817 字</span>
        &middot;
        <span class="reading_time">大约需要 5 分钟</span>
    
</div>


    <div class="post-content">
        <p>最近把博客从Jekyll迁移到了Hugo，在这里记录一下。 </p>
<p>之前一直使用Jekyll，最大的原因是Github Pages原生支持Jekyll，
repo里只管理源代码就可以，不需要上传build之后的文件。
不过Jekyll也有许多不尽如人意的地方，主要是一下几点：</p>
<ul>
<li>本地开发环境不容易配置。
没有直接的可执行文件，需要安装ruby，gem，之后再安装jekyll</li>
<li>Github Pages的build配置不能按照自己的需求定制。
各种依赖的版本不能自己选择，也不能根据使用Jekyll的一些插件</li>
<li>编译速度慢。
因为本站的文章太少，这一点倒是不是什么问题</li>
</ul>
<h1 id="nei-rong-qian-yi">内容迁移</h1>
<p>博客从Jekyll迁移到Hugo，在考虑主题迁移的情况下，还是比较简单的。
Hugo的命令行可以直接从Jekyll导入文章，</p>
<pre data-lang="bash" style="background-color:#f9f9f9;color:#111111;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#c82728;">hugo</span><span style="color:#4271ae;"> import jekyll /path/to/jekyll/root /target/path
</span></code></pre>
<p>这样可以直接导入文章，Jekyll中其他的静态文件会被放到<code>static</code>文件夹中。
这个命令比较简单，但并没有把所有事情干完。只是把Jekyll中的文章放到了Hugo中，
并且根据文件名里的时间，放到了front matter中，其他并没有改动。
文件名也仍然需要自己手动修改，去掉时间。</p>
<p>此外，Hugo使用的markdown，在语法上也与Jekyll有些差异，渲染出来的html也是有些不同。
这里可以在Hugo的配置文件里进行修改，也可以修改文章的语法。</p>
<h1 id="zi-dong-bian-yi">自动编译</h1>
<p>使用Jekyll的时候其实是不需要这一步的，直接推到github上就行了。
使用hugo，如果每次都是本地编译，然后把编译后的html文件推到github，
那就太不方便了。而且这样也不利于源码文件的管理。</p>
<h2 id="travis-ci">Travis CI</h2>
<p>Travis CI是持续集成服务，并且对于Github上的public repo是免费使用的。
利用Travis CI，可以达到每次push到Github上的时候，自动build，
并推送到repo的特定的分支。</p>
<p>首先需要在Travis CI上开启repo的自动集成，然后在repo里添加<code>.travis.yml</code>。
Travis CI会根据这个文件，进行build。根据<a href="https://docs.travis-ci.com/user/customizing-the-build">Travis CI的文档</a>，
build过程分为几个阶段。一个静态博客的build，比较简单，
也不用所有的过程都用上。在<code>install</code>阶段安装hugo，<code>script</code>阶段调用hugo进行编译，
<code>after_success</code>阶段把生成的文件推到github上。这是本站的使用的配置。</p>
<pre data-lang="yml" style="background-color:#f9f9f9;color:#111111;" class="language-yml "><code class="language-yml" data-lang="yml"><span style="color:#8e908c;"># .traivs.yml
</span><span style="color:#c82728;">language</span><span>: </span><span style="color:#839c00;">go
</span><span style="color:#c82728;">go</span><span>:
</span><span> - </span><span style="color:#839c00;">&#39;1.10&#39;
</span><span style="color:#c82728;">branches</span><span>:
</span><span>  </span><span style="color:#c82728;">only</span><span>:
</span><span>  - </span><span style="color:#839c00;">source </span><span style="color:#8e908c;"># 只有source分支的推送才触发构建
</span><span style="color:#c82728;">install</span><span>:
</span><span>  - </span><span style="color:#839c00;">wget /path/to/hugo/releases -O /tmp/hugo.tar.gz
</span><span>  - </span><span style="color:#839c00;">mkdir -p bin
</span><span>  - </span><span style="color:#839c00;">tar -xvf /tmp/hugo.tar.gz -C bin
</span><span style="color:#c82728;">script</span><span>:
</span><span>  - </span><span style="color:#839c00;">bin/hugo
</span><span style="color:#c82728;">after_success</span><span>:
</span><span>  - </span><span style="color:#839c00;">sh .travis/push.sh
</span></code></pre>
<pre data-lang="bash" style="background-color:#f9f9f9;color:#111111;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#8e908c;"># push.sh
</span><span style="color:#4271ae;">setup_git</span><span>() {
</span><span>    </span><span style="color:#c82728;">git</span><span style="color:#4271ae;"> config</span><span style="color:#f07219;"> --global</span><span style="color:#4271ae;"> user.name </span><span style="color:#839c00;">&quot;travis@travis-ci.org&quot;
</span><span>    </span><span style="color:#c82728;">git</span><span style="color:#4271ae;"> config</span><span style="color:#f07219;"> --global</span><span style="color:#4271ae;"> user.email </span><span style="color:#839c00;">&quot;Travis CI&quot;
</span><span>}
</span><span>
</span><span style="color:#4271ae;">commit_files</span><span>() {
</span><span>    </span><span style="color:#c82728;">git</span><span style="color:#4271ae;"> init
</span><span>    </span><span style="color:#c82728;">git</span><span style="color:#4271ae;"> add .
</span><span>    </span><span style="color:#c82728;">git</span><span style="color:#4271ae;"> commit</span><span style="color:#f07219;"> -m</span><span style="color:#839c00;">&quot;Travis build: $</span><span style="color:#c82728;">TRAVIS_BUILD_NUMBER</span><span style="color:#839c00;">&quot;
</span><span>}
</span><span>
</span><span style="color:#4271ae;">push</span><span>() {
</span><span>    </span><span style="color:#c82728;">git</span><span style="color:#4271ae;"> remote add origin https://${</span><span style="color:#c82728;">GH_TOKEN</span><span style="color:#4271ae;">}@github.com/yourname/yourrepo.git
</span><span>    </span><span style="color:#c82728;">git</span><span style="color:#4271ae;"> push</span><span style="color:#f07219;"> -f -u</span><span style="color:#4271ae;"> origin master
</span><span>}
</span><span>
</span><span style="color:#4271ae;">cd public
</span><span style="color:#c82728;">setup_git
</span><span style="color:#c82728;">commit_files
</span><span style="color:#c82728;">push
</span></code></pre>
<p>由于Travis CI并没有repo的push权限，所以直接推到repo上是会验证失败的。
<code>push.sh</code>里，<code>GH_TOKEN</code>是有<code>public_repo</code>权限的personal access token，
可以在<a href="https://github.com/settings/tokens">https://github.com/settings/tokens</a>申请，并在Travis CI上设置。</p>
<p>至此，Travis CI的自动build就完成了。</p>

    </div>
</div>


<span id="comments"></span>
<script src="https://utteranc.es/client.js"
        repo="iEverX/ieverx.github.io"
        issue-term="pathname"
            label="comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>




    <div class="navigation">
            <span class="prev"></span>
        
            <span class="next"></span>
        
    </div>


        </div>
    </div>
        
<div id="footer">
    <div class="footer-container">
        <div class="copyright" >
            <span> &copy; 2012 - 2024</span>
            &hearts;
            <span class="author">天外天</span>
        </div>
        <div class="support">
            <span class="powered-by">本站由 <a href="https://getzola.org" target="_blank">zola</a> 驱动</span>
            &middot;
            <span class="theme">采用 <a href="https://github.com/ieverx/zola-theme-ink" target="_blank">ink</a> 主题</span>
        </div>
    </div>
</div>

    
        
    <!-- Google Analytics -->
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-54098391-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-54098391-1');
    </script>
    <!-- End Google Analytics -->


    
</body>
</html>
